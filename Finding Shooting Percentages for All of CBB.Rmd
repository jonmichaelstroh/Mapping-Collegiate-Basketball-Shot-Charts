---
title: "Finding Shooting Percentages for All of CBB"
author: '@jonmichaelstroh'
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, 
                      echo = TRUE, dpi = 300, cache.lazy = FALSE,
                      tidy = "styler")
```

```{r load libraries}
library(tidyverse)
library(dplyr)
library(gamezoneR)
```

```{r Big Ten Team Schedules}
wisconsin_schedule_2020 <-  gamezoneR::get_team_schedule("Wisconsin", season = "2020-21")
michigan_schedule_2020 <-  gamezoneR::get_team_schedule("Michigan", season = "2020-21")
purdue_schedule_2020 <-  gamezoneR::get_team_schedule("Purdue", season = "2020-21")
iowa_schedule_2020 <-  gamezoneR::get_team_schedule("Iowa", season = "2020-21")
illinois_schedule_2020 <-  gamezoneR::get_team_schedule("Illinois", season = "2020-21")
michiganst_schedule_2020 <-  gamezoneR::get_team_schedule("Michigan State", season = "2020-21")
ohiost_schedule_2020 <-  gamezoneR::get_team_schedule("Ohio State", season = "2020-21")
indiana_schedule_2020 <-  gamezoneR::get_team_schedule("Indiana", season = "2020-21")
maryland_schedule_2020 <-  gamezoneR::get_team_schedule("Maryland", season = "2020-21")
rutgers_schedule_2020 <-  gamezoneR::get_team_schedule("Rutgers", season = "2020-21")
minnesota_schedule_2020 <-  gamezoneR::get_team_schedule("Minnesota", season = "2020-21")
pennst_schedule_2020 <-  gamezoneR::get_team_schedule("Penn State", season = "2020-21")
nebraska_schedule_2020 <-  gamezoneR::get_team_schedule("Nebraska", season = "2020-21")
northwestern_schedule_2020 <-  gamezoneR::get_team_schedule("Northwestern", season = "2020-21")

big_ten_schedule <- multiFull <- merge(merge(merge(merge(merge(merge(merge(merge(merge(merge(merge(merge(merge(
  wisconsin_schedule_2020,
  michigan_schedule_2020, all = TRUE),
  purdue_schedule_2020, all = TRUE),
  iowa_schedule_2020, all = TRUE),
  illinois_schedule_2020, all = TRUE),
  michiganst_schedule_2020, all = TRUE),
  ohiost_schedule_2020, all = TRUE),
  indiana_schedule_2020, all = TRUE),
  maryland_schedule_2020, all = TRUE),
  rutgers_schedule_2020, all = TRUE),
  minnesota_schedule_2020, all = TRUE),
  pennst_schedule_2020, all = TRUE),
  nebraska_schedule_2020, all = TRUE),
  northwestern_schedule_2020, all = TRUE)

view(big_ten_schedule)
```

```{r Shot data for Big Ten}
big_ten_shot_data <- purrr::map_df(big_ten_schedule$game_id, 
                          gamezoneR::gamezone_cbb_pbp, sub_parse = F) %>% filter(!is.na(loc_x)) %>% filter(home == event_team)
```

```{r Check Quadrants}
big_ten_shot_data  <- big_ten_shot_data  %>% mutate(shot_quadrant = factor(if_else(loc_x >= 21 & loc_x <= 25 & ((loc_y - 5.25)^2 + (25 - loc_x)^2 <= 16), "Q1", if_else(loc_x > 25 & loc_x <= 29 & ((loc_y - 5.25)^2 + (loc_x - 25)^2 <= 16), "Q1", if_else(loc_x >= 19 & loc_x <= 31 & loc_y <= 19, "Q2", if_else(loc_x <= 12.5 & three_pt == TRUE, "Q5", if_else(loc_x > 12.5 & loc_x < 37.5 & three_pt == TRUE, "Q6", if_else(loc_x >= 37.5 & three_pt == TRUE, "Q7", if_else(loc_x <= 25, "Q3", if_else(loc_x > 25, "Q4", "NA"))))))))))
```

```{r Total by Quadrant}
big_ten_shot_quadrants <- table(big_ten_shot_data$shot_quadrant, big_ten_shot_data$shot_outcome)

big_ten_shot_quadrants
```

```{r Percentages by Quadrant}
big_ten_shot_quadrant_percentages_2020 <- as.data.frame.matrix(round(prop.table(big_ten_shot_quadrants, 1), digits = 5) * 100)

big_ten_shot_quadrant_percentages_2020 <- big_ten_shot_quadrant_percentages_2020 %>% mutate(Quadrant = 1:nrow(big_ten_shot_quadrant_percentages_2020)) %>% mutate(made = paste0(made,"%"))

big_ten_shot_quadrant_percentages_2020
```

```{r}

```









